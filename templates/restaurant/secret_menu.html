<!DOCTYPE html>
<html>
<head>
  <title>Secret Menu | LastPlate Partner</title>
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@500;700&display=swap" rel="stylesheet">

  <style>
    body { background: #020202; color: white; font-family: Plus Jakarta Sans; padding: 30px; }
    h1 { font-size: 28px; margin-bottom: 20px; }

    .item {
      display: flex;
      align-items: center;
      gap: 20px;
      padding: 18px;
      background: rgba(255,255,255,0.06);
      border-radius: 16px;
      margin-bottom: 15px;
    }

    img {
      width: 80px; height: 80px; border-radius: 12px; object-fit: cover;
    }

    .name { font-size: 18px; font-weight: 700; }
    .price { opacity: .7; }

    .toggle {
      margin-left: auto;
      width: 55px; height: 30px;
      background: #444;
      border-radius: 25px;
      position: relative;
      cursor: pointer;
      transition: .3s;
    }
    .toggle.active { background: #00ffa3; }

    .knob {
      width: 26px; height: 26px;
      background: white;
      border-radius: 50%;
      position: absolute;
      top: 2px; left: 2px;
      transition: .3s;
    }
    .toggle.active .knob {
      left: 27px;
    }
  </style>
</head>

<body>
  <header>
    <div class="section-title">
    <h3>üç≥ Secret Menu Dishes</h3>

    <a href="/restaurant/secret-menu/add" 
       class="btn-main btn-primary" 
       style="padding:10px 20px; border-radius:12px; font-size:14px;">
        ‚ûï Add Secret Dish
    </a>
</div>
  </header>

<h1>Secret Menu</h1>
<div id="list"></div>

<script>
async function loadSecret() {
  const res = await fetch("/restaurant/api/my-secret-menu");
  const items = await res.json();

  const list = document.getElementById("list");
  list.innerHTML = "";

  items.forEach(i => {
    list.innerHTML += `
      <div class="item">
        <img src="${i.img}">
        <div>
          <div class="name">${i.name}</div>
          <div class="price">‚Çπ${i.price} ¬∑ Stock: ${i.stock}</div>
        </div>

        <div class="toggle ${i.is_today_special ? 'active' : ''}" onclick="toggleSpecial(${i.id}, this)">
          <div class="knob"></div>
        </div>
      </div>
    `;
  });
}

async function toggleSpecial(id, el) {
  el.classList.toggle("active");
  await fetch(`/restaurant/api/toggle-secret/${id}`, { method: "POST" });
}

loadSecret();
</script>

</body>
</html>
